theme_bw() +
theme(axis.title.x = element_text(size = 12.5),  # Adjust the size of x-axis title
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5)) + # Adjust the size of y-axis title
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = setNames(LU_names, 1:5)))
# All Factors - 5 Subplots - REVISION
LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean and SD per Date",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),  # Adjust the size of x-axis title
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 10)) + # Adjust the size of y-axis title
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = setNames(LU_names, 1:5)))
# All Factors - 5 Subplots - REVISION
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),  # Adjust the size of x-axis title
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 10)) + # Adjust the size of y-axis title
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = setNames(LU_names, 1:5)))
mean_LU
# Does not work probably
LU_pivot_df$model <- factor(LU_pivot_df$model,
levels = c("SEBAL", "SSEB", "METRIC", "WASIM"))
# All Factors - 5 Subplots - REVISION
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),  # Adjust the size of x-axis title
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 10)) + # Adjust the size of y-axis title
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = setNames(LU_names, 1:5)))
mean_LU
ggsave(mean_LU, filename = paste(path_plots, "/mean_LU.png", sep = ""),
width = 3212, height = 1942, units = "px")
# All Factors - 5 Subplots - REVISION
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),  # Adjust the size of x-axis title
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 10)) + # Adjust the size of y-axis title
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = setNames(LU_names, 1:5)))
ggsave(mean_LU, filename = paste(path_plots, "/mean_LU.png", sep = ""),
width = 3000, height = 2200, units = "px")
# All Factors - 5 Subplots - REVISION
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),  # Adjust the size of x-axis title
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 10)) + # Adjust the size of y-axis title
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = setNames(LU_names, 1:5)))
ggsave(mean_LU, filename = paste(path_plots, "/mean_LU.png", sep = ""),
width = 3200, height = 2200, units = "px")
# All Factors - 5 Subplots - REVISION
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),  # Adjust the size of x-axis title
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 10)) + # Adjust the size of y-axis title
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = setNames(LU_names, 1:5)))
ggsave(mean_LU, filename = paste(path_plots, "/mean_LU.png", sep = ""),
width = 3200, height = 2500, units = "px")
# All Factors - 5 Subplots - REVISION
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),  # Adjust the size of x-axis title
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 10)) + # Adjust the size of y-axis title
scale_x_continuous(limits = c(0, 8)) +
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = setNames(LU_names, 1:5)))
mean_LU
summary_table <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
group_by(LandUse) %>%
summarize(n = n())
# Extract the counts and convert to a named vector
LU_counts <- setNames(summary_table$n, summary_table$LandUse)
# Create the labeller function
custom_labeller <- function(variable, value) {
if (variable == "LandUse") {
return(paste0(LU_names[value], " (n = ", LU_counts[value], ")"))
} else {
return(value)
}
}
# Use the labeller function in facet_wrap
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 10)) +
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = custom_labeller))
mean_LU
n
n
LU_counts
# Use the labeller function in facet_wrap
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 10)) +
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller("test"))
mean_LU
# Use the labeller function in facet_wrap
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 10)) +
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse))
mean_LU
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),  # Adjust the size of x-axis title
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 10)) + # Adjust the size of y-axis title
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = setNames(LU_names, 1:5)))
mean_LU
ggsave(mean_LU, filename = paste(path_plots, "/mean_LU.png", sep = ""),
width = 3200, height = 2500, units = "px")
View(LU_mean_combined)
View(SEBAL_ts)
View(SEBAL_ts)
SEBAL_ts %>%
filter(LandUse == 1) %>%
table(.)
SEBAL_ts %>%
filter(LandUse == 1) %>%
table()
SEBAL_ts %>%
filter(LandUse == 1) %>%
summarise_all(~ sum(!is.na(.)))
SEBAL_ts %>%
filter(LandUse == 1) %>%
########
# Add Land Use names and n for each factor
LU_names <- c("Agriculture", "Bare Soil", "Grassland", "Urban Area", "Forest")
SEBAL_ts %>%
summarise_all(~ sum(!is.na(.)))
SEBAL_ts %>%
filter(LandUse == 1) %>%
summarise_all(~ sum(!is.na(.)))
summary_table <- SEBAL_ts %>%
group_by(LandUse) %>%
summarise_all(~ sum(!is.na(.)))
# If you want to arrange the columns in a specific order (1 to 5)
summary_table <- summary_table[, order(as.numeric(names(summary_table)))]
# If you want to set meaningful column names
col_names <- paste0("LandUse_", 1:5)
colnames(summary_table) <- col_names
print(summary_table)
summary_table <- SEBAL_ts %>%
group_by(LandUse) %>%
summarise_all(~ sum(!is.na(.)))
summary_table
View(summary_table)
n_SEBAL <- as.data.frame(summary_table)
n_SEBAL
View(n_SEBAL)
n_SEBAL <- SEBAL_ts %>%
group_by(LandUse) %>%
summarise_all(~ sum(!is.na(.))) %>%
as.data.frame()
View(n_SEBAL)
##############
## Find number of observations n
n_SEBAL <- SEBAL_ts %>%
group_by(LandUse) %>%
summarise_all(~ sum(!is.na(.))) %>%
as.data.frame()
n_SSEB <- SSEB_ts %>%
group_by(LandUse) %>%
summarise_all(~ sum(!is.na(.))) %>%
as.data.frame()
n_METRIC <- METRIC_ts %>%
group_by(LandUse) %>%
summarise_all(~ sum(!is.na(.))) %>%
as.data.frame()
n_WASIM <- WASIM_ts %>%
group_by(LandUse) %>%
summarise_all(~ sum(!is.na(.))) %>%
as.data.frame()
View(n_METRIC)
View(n_SEBAL)
View(n_SSEB)
View(n_WASIM)
########
# Add Land Use names and n for each factor
LU_names <- c("Agriculture, n ≈ 261.000", "Bare Soil, n ≈ 600", "Grassland, n ≈ 172.000", "Urban Area, n ≈ 34.000", "Forest, n ≈ 280.000")
# All Factors - 5 Subplots - REVISION
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),  # Adjust the size of x-axis title
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 10)) + # Adjust the size of y-axis title
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = setNames(LU_names, 1:5)))
mean_LU
########
# Add Land Use names and n for each factor
LU_names <- c("Agriculture  (n ≈ 261.000)", "Bare Soil  (n ≈ 600)", "Grassland  (n ≈ 172.000)", "Urban Area  (n ≈ 34.000)", "Forest  (n ≈ 280.000)")
# All Factors - 5 Subplots - REVISION
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),  # Adjust the size of x-axis title
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 10)) + # Adjust the size of y-axis title
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = setNames(LU_names, 1:5)))
mean_LU
ggsave(mean_LU, filename = paste(path_plots, "/mean_LU.png", sep = ""),
width = 3200, height = 2500, units = "px")
# All Factors - 5 Subplots - REVISION
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),  # Adjust the size of x-axis title
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 11)) + # Adjust the size of y-axis title
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = setNames(LU_names, 1:5)))
ggsave(mean_LU, filename = paste(path_plots, "/mean_LU.png", sep = ""),
width = 3200, height = 2500, units = "px")
# All Factors - 5 Subplots - REVISION
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),  # Adjust the size of x-axis title
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 11)) + # Adjust the size of y-axis title
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = setNames(LU_names, 1:5)))
mean_LU
ggsave(mean_LU, filename = paste(path_plots, "/mean_LU.png", sep = ""),
width = 3200, height = 2500, units = "px")
# All Factors - 5 Subplots - REVISION
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),  # Adjust the size of x-axis title
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 12)) + # Adjust the size of y-axis title
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = setNames(LU_names, 1:5)))
mean_LU
ggsave(mean_LU, filename = paste(path_plots, "/mean_LU.png", sep = ""),
width = 3200, height = 2500, units = "px")
# All Factors - 5 Subplots - REVISION
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.4,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),  # Adjust the size of x-axis title
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 10)) + # Adjust the size of y-axis title
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = setNames(LU_names, 1:5)))
ggsave(mean_LU, filename = paste(path_plots, "/mean_LU.png", sep = ""),
width = 3200, height = 2500, units = "px")
# All Factors - 5 Subplots - REVISION
mean_LU <- LU_pivot_df %>%
filter(LandUse %in% 1:5) %>%
ggplot(aes(x = date, y = mean, fill = model, group = model)) +
geom_col(position=position_dodge()) +
geom_errorbar(aes(ymin=mean-sd, ymax=mean+sd), width=0.3,
position=position_dodge(0.9)) +
labs(title = "ETa Mean per Land Use class",
x = "Date",
y = "Mean ETa (mm)",
fill = "Model") +
theme_bw() +
theme(axis.title.x = element_text(size = 12.5),  # Adjust the size of x-axis title
axis.title.y = element_text(size = 12.5),
plot.title = element_text(size = 14.5),
axis.text.x = element_text(size = 10),
axis.text.y = element_text(size = 10),
legend.text = element_text(size = 10),
legend.title = element_text(size = 12.5),
strip.text = element_text(size = 10)) + # Adjust the size of y-axis title
facet_wrap(~LandUse, scales = "free_y", ncol = 1, labeller = labeller(LandUse = setNames(LU_names, 1:5)))
ggsave(mean_LU, filename = paste(path_plots, "/mean_LU.png", sep = ""),
width = 3200, height = 2500, units = "px")
